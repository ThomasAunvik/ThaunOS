# Toolchain
AS = i686-elf-as
CC = i686-elf-gcc
LD = i686-elf-gcc

# Compiler flags
CFLAGS = -std=gnu99 -ffreestanding -O2 -Wall -Wextra
LDFLAGS = -ffreestanding -O2 -nostdlib

# Target
TARGET = thaunos.bin

# Object files
OBJS = boot.o kernel.o

# Default target
all: $(TARGET)

# Link kernel
$(TARGET): $(OBJS)
	$(LD) -T linker.ld -o $@ $(LDFLAGS) $(OBJS) -lgcc

# Compile boot.asm
boot.o: boot.asm
	$(AS) boot.asm -o boot.o

# Compile kernel.c
kernel.o: kernel.c
	$(CC) -c kernel.c -o kernel.o $(CFLAGS)

# Clean build artifacts
clean:
	rm -f $(OBJS) $(TARGET)

.PHONY: all clean
